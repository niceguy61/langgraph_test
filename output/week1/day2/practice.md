# Week 1 Day 2 ì‹¤ìŠµ ê°€ì´ë“œ

## âš ï¸ í•„ìˆ˜ ì‚¬ì „ ì¤€ë¹„

> **ğŸš¨ ì¤‘ìš”:** ì‹¤ìŠµì„ ì‹œì‘í•˜ê¸° ì „ì— ë°˜ë“œì‹œ ì•„ë˜ ê°€ì´ë“œë¥¼ ë¨¼ì € ì™„ë£Œí•˜ì„¸ìš”!

### ğŸ“š í•„ìˆ˜ ì„ í–‰ ë¬¸ì„œ
ì‹¤ìŠµì„ ì‹œì‘í•˜ê¸° ì „ì— ë‹¤ìŒ ë¬¸ì„œë“¤ì„ **ë°˜ë“œì‹œ** ë¨¼ì € ì½ê³  ì™„ë£Œí•˜ì„¸ìš”:

| ë¬¸ì„œ | ì„¤ëª… | í•„ìˆ˜ ì—¬ë¶€ |
|-----|------|----------|
| [AWS ê³„ì • ìƒì„± ê°€ì´ë“œ](../prerequisites/aws-account-setup.md) | AWS ê³„ì •ì´ ì—†ë‹¤ë©´ ì´ ê°€ì´ë“œë¥¼ ë”°ë¼ ê³„ì •ì„ ìƒì„±í•˜ì„¸ìš” | âœ… í•„ìˆ˜ |
| [AWS CLI ì„¤ì¹˜ ê°€ì´ë“œ](../prerequisites/aws-cli-setup.md) | AWS CLI ì„¤ì¹˜ ë° ì„¤ì • ë°©ë²• | âœ… í•„ìˆ˜ |
| [IAM ì‚¬ìš©ì ìƒì„± ê°€ì´ë“œ](../prerequisites/iam-user-setup.md) | ì‹¤ìŠµìš© IAM ì‚¬ìš©ì ìƒì„± ë°©ë²• | âœ… í•„ìˆ˜ |
| [VS Code ì„¤ì • ê°€ì´ë“œ](../prerequisites/vscode-setup.md) | ê°œë°œ í™˜ê²½ ì„¤ì • (ì„ íƒ) | ì„ íƒ |

### âœ… ì‚¬ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸
ì‹¤ìŠµì„ ì‹œì‘í•˜ê¸° ì „ ì•„ë˜ í•­ëª©ë“¤ì„ ëª¨ë‘ í™•ì¸í•˜ì„¸ìš”:

- [ ] AWS ê³„ì •ì´ ìˆê³  ë¡œê·¸ì¸í•  ìˆ˜ ìˆë‹¤
- [ ] AWS CLIê°€ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ (`aws --version` ìœ¼ë¡œ í™•ì¸)
- [ ] AWS CLI ìê²© ì¦ëª…ì´ ì„¤ì •ë˜ì–´ ìˆë‹¤ (`aws sts get-caller-identity` ë¡œ í™•ì¸)
- [ ] ì‹¤ìŠµì— í•„ìš”í•œ IAM ê¶Œí•œì´ ìˆë‹¤
- [ ] ê²°ì œ ì•Œë¦¼ì´ ì„¤ì •ë˜ì–´ ìˆë‹¤ (ì˜ˆìƒì¹˜ ëª»í•œ ë¹„ìš© ë°©ì§€)

```bash
# ì‚¬ì „ ì¤€ë¹„ í™•ì¸ ëª…ë ¹ì–´
aws --version
aws sts get-caller-identity
```

> **âš ï¸ ì£¼ì˜:** ìœ„ ì²´í¬ë¦¬ìŠ¤íŠ¸ê°€ ëª¨ë‘ ì™„ë£Œë˜ì§€ ì•Šì•˜ë‹¤ë©´ ì‹¤ìŠµì„ ì§„í–‰í•˜ì§€ ë§ˆì„¸ìš”!  
> ë¬¸ì œ ë°œìƒ ì‹œ í•´ê²°ì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ¯ ì‹¤ìŠµ ëª©í‘œ
ì´ ì‹¤ìŠµì„ ì™„ë£Œí•˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- [ ] IAM ì‚¬ìš©ì ë° ì—­í•  ìƒì„±
- [ ] STSë¥¼ í†µí•œ ì„ì‹œ ìê²© ì¦ëª… ìƒì„±
- [ ] ì„œë¹„ìŠ¤ ì—°ê²° ì—­í•  ë° ê¶Œí•œ ê²½ê³„ ì ìš©

## â±ï¸ ì˜ˆìƒ ì†Œìš” ì‹œê°„
- ì „ì²´ ì‹¤ìŠµ: ì•½ 30-45ë¶„
- Step 1: ì•½ 10ë¶„
- Step 2: ì•½ 15ë¶„
- Step 3: ì•½ 10ë¶„
- ë¦¬ì†ŒìŠ¤ ì •ë¦¬: ì•½ 5ë¶„

---

## ğŸ“ ì‹¤ìŠµ ë‹¨ê³„

### Step 1: IAM ì—­í•  ìƒì„± ë° trust ì •ì±… ì„¤ì • (ì•½ 10ë¶„)

#### 1.1 IAM ì—­í•  ìƒì„±
```bash
# EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ì—­í• ì„ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ trust ì •ì±… ìƒì„±
aws iam create-role --role-name EC2-ReadOnlyRole --assume-role-policy-document file://trust-policy.json
```

**trust-policy.json** íŒŒì¼ ë‚´ìš©:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": { "Service": "ec2.amazonaws.com" },
      "Action": "sts:AssumeRole"
    }
  ]
}
```

**ì˜ˆìƒ ì¶œë ¥:**
```
{
    "Role": {
        "RoleId": "AROASD...",
        "RoleName": "EC2-ReadOnlyRole",
        "Arn": "arn:aws:iam::123456789012:role/EC2-ReadOnlyRole"
    }
}
```

> **ğŸ’¡ ì„¤ëª…:** ì´ ëª…ë ¹ì–´ëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ì—­í• ì„ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ trust ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤.  
> `trust-policy.json` íŒŒì¼ì€ ì—­í• ì„ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤(ì˜ˆ: EC2)ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

#### 1.2 IAM ì •ì±… ì—°ê²°
**AWS ì½˜ì†”ì—ì„œ:**
1. ì„œë¹„ìŠ¤ ê²€ìƒ‰ì°½ì—ì„œ "IAM" ì…ë ¥
2. IAM ì„œë¹„ìŠ¤ í´ë¦­
3. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ "Roles" ì„ íƒ
4. ìƒì„±í•œ `EC2-ReadOnlyRole` í´ë¦­
5. "Permissions" íƒ­ì—ì„œ "Attach policies" í´ë¦­
6. "AmazonS3ReadOnlyAccess" ì •ì±… ì„ íƒ ë° ì ìš©

> **ğŸ“¸ í™”ë©´ í™•ì¸:** "AmazonS3ReadOnlyAccess" ì •ì±…ì´ ì •ìƒì ìœ¼ë¡œ ì—°ê²°ëœ ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.

#### âœ… Step 1 ì™„ë£Œ í™•ì¸
- [ ] EC2-ReadOnlyRole ì—­í• ì´ ìƒì„±ë¨
- [ ] AmazonS3ReadOnlyAccess ì •ì±…ì´ ì—°ê²°ë¨

---

### Step 2: STSë¥¼ í†µí•œ ì„ì‹œ ìê²© ì¦ëª… ìƒì„± (ì•½ 15ë¶„)

#### 2.1 STSë¡œ ì„ì‹œ ìê²© ì¦ëª… ìƒì„±
```bash
# ì„ì‹œ ìê²© ì¦ëª… ìƒì„± (EC2 ì—­í• ì„ ê°€ì •)
aws sts get-federation-token --name EC2-ReadOnlyRole --duration-seconds 3600
```

**ì˜ˆìƒ ì¶œë ¥:**
```
{
    "Credentials": {
        "AccessKeyId": "ASIA...",
        "SecretAccessKey": "wJalr...",
        "SessionToken": "IQoJ...",
        "Expiration": "2023-10-10T12:34:56Z"
    }
}
```

> **ğŸ’¡ ì„¤ëª…:** STSëŠ” ì„ì‹œ ìê²© ì¦ëª…ì„ ìƒì„±í•˜ì—¬ ë‹¤ë¥¸ ì„œë¹„ìŠ¤(ì˜ˆ: S3)ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.  
> ìƒì„±ëœ ìê²© ì¦ëª…ì€ 1ì‹œê°„ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤.

#### 2.2 ì„ì‹œ ìê²© ì¦ëª…ìœ¼ë¡œ S3 ì ‘ê·¼
```bash
# ì„ì‹œ ìê²© ì¦ëª… ì‚¬ìš©í•˜ì—¬ S3 ë²„í‚· ëª©ë¡ í™•ì¸
aws s3 ls s3://my-bucket --region us-east-1
```

> **ğŸ“¸ í™”ë©´ í™•ì¸:** S3 ë²„í‚· ëª©ë¡ì´ ì •ìƒì ìœ¼ë¡œ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

#### âœ… Step 2 ì™„ë£Œ í™•ì¸
- [ ] ì„ì‹œ ìê²© ì¦ëª…ì´ ìƒì„±ë¨
- [ ] S3 ë²„í‚· ëª©ë¡ì´ ì„±ê³µì ìœ¼ë¡œ ì¡°íšŒë¨

---

### Step 3: ì„œë¹„ìŠ¤ ì—°ê²° ì—­í•  ë° ê¶Œí•œ ê²½ê³„ ì„¤ì • (ì•½ 10ë¶„)

#### 3.1 ì„œë¹„ìŠ¤ ì—°ê²° ì—­í•  ìƒì„±
**AWS ì½˜ì†”ì—ì„œ:**
1. ì„œë¹„ìŠ¤ ê²€ìƒ‰ì°½ì—ì„œ "IAM" ì…ë ¥
2. IAM ì„œë¹„ìŠ¤ í´ë¦­
3. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ "Roles" ì„ íƒ
4. "Create role" í´ë¦­
5. "Service"ì—ì„œ "S3" ì„ íƒ
6. "Next: Permissions" í´ë¦­
7. "Service-linked role" ìƒì„± ë° í™•ì¸

> **ğŸ’¡ ì„¤ëª…:** S3 ì„œë¹„ìŠ¤ëŠ” ìì²´ ì—°ê²° ì—­í• ì„ ì‚¬ìš©í•˜ì—¬ AWS ì„œë¹„ìŠ¤ ê°„ í†µí•©ì„ ë³´ì¥í•©ë‹ˆë‹¤.  
> ì—°ê²° ì—­í• ì€ AWS ì„œë¹„ìŠ¤ê°€ ìë™ìœ¼ë¡œ ìƒì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.

#### 3.2 ê¶Œí•œ ê²½ê³„ ì ìš©
```bash
# ê¶Œí•œ ê²½ê³„ ì •ì±… ìƒì„±
aws iam create-policy --policy-name ReadOnlyBoundary --policy-document file://boundary-policy.json
```

**boundary-policy.json** íŒŒì¼ ë‚´ìš©:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": "s3:*",
      "Resource": "arn:aws:s3:::my-bucket/*"
    }
  ]
}
```

```bash
# ê¶Œí•œ ê²½ê³„ ì—°ê²°
aws iam attach-role-policy --role-name EC2-ReadOnlyRole --policy-arn arn:aws:iam::123456789012:policy/ReadOnlyBoundary
```

> **ğŸ“¸ í™”ë©´ í™•ì¸:** "ReadOnlyBoundary" ì •ì±…ì´ ì—­í• ì— ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ëœ ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.

#### âœ… Step 3 ì™„ë£Œ í™•ì¸
- [ ] ì„œë¹„ìŠ¤ ì—°ê²° ì—­í• ì´ ìƒì„±ë¨
- [ ] ê¶Œí•œ ê²½ê³„ ì •ì±…ì´ ì—­í• ì— ì—°ê²°ë¨

---

## âœ… ì‹¤ìŠµ ì™„ë£Œ í™•ì¸

### ìµœì¢… í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] IAM ì—­í•  ìƒì„± ì™„ë£Œ
- [ ] STS ì„ì‹œ ìê²© ì¦ëª… ìƒì„± ì™„ë£Œ
- [ ] ì„œë¹„ìŠ¤ ì—°ê²° ì—­í•  ë° ê¶Œí•œ ê²½ê³„ ì ìš© ì™„ë£Œ

### ì˜ˆìƒ ìµœì¢… ê²°ê³¼
```bash
# ìµœì¢… í™•ì¸ ëª…ë ¹ì–´
aws sts get-caller-identity
```

**ì˜ˆìƒ ì¶œë ¥:**
```
{
    "UserId": "AROASD...",
    "Account": "123456789012",
    "Arn": "arn:aws:sts::123456789012:assumed-role/EC2-ReadOnlyRole/..."
}
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: `InvalidRoleAction` ì˜¤ë¥˜
**ì¦ìƒ:** `The action ... is not allowed` ë©”ì‹œì§€

**ì›ì¸:** ì—­í• ì´ í•„ìš”í•œ ê¶Œí•œì„ ê°€ì§€ê³  ìˆì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•:**
```bash
# ì—­í• ì— í•„ìš”í•œ ì •ì±… ì¶”ê°€
aws iam attach-role-policy --role-name EC2-ReadOnlyRole --policy-arn arn:aws:iam::123456789012:policy/AmazonS3ReadOnlyAccess
```

### ë¬¸ì œ 2: `AccessDenied` ì˜¤ë¥˜
**ì¦ìƒ:** `AccessDenied` ë˜ëŠ” `UnauthorizedAccess` ì˜¤ë¥˜

**í•´ê²° ë°©ë²•:**
1. IAM ì‚¬ìš©ì ê¶Œí•œ í™•ì¸
2. í•„ìš”í•œ ì •ì±… ì—°ê²°
```bash
# í˜„ì¬ ì‚¬ìš©ì ê¶Œí•œ í™•ì¸
aws sts get-caller-identity
```

---

## ğŸ§¹ ë¦¬ì†ŒìŠ¤ ì •ë¦¬ (í•„ìˆ˜!)

> **âš ï¸ ì¤‘ìš”:** ì‹¤ìŠµ ì™„ë£Œ í›„ ë°˜ë“œì‹œ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•˜ì„¸ìš”!  
> ì •ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ **ì˜ˆìƒì¹˜ ëª»í•œ ë¹„ìš©**ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì •ë¦¬í•  ë¦¬ì†ŒìŠ¤ ëª©ë¡
- [ ] EC2-ReadOnlyRole ì—­í• 
- [ ] ReadOnlyBoundary ì •ì±…
- [ ] ìƒì„±ëœ ì„ì‹œ ìê²© ì¦ëª…

### ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ëª…ë ¹ì–´
```bash
# 1. ì—­í•  ì‚­ì œ
aws iam delete-role --role-name EC2-ReadOnlyRole

# 2. ì •ì±… ì‚­ì œ
aws iam delete-policy --policy-name ReadOnlyBoundary

# 3. ì‚­ì œ í™•ì¸
aws iam list-roles
aws iam list-policies
```

### ì •ë¦¬ ì™„ë£Œ í™•ì¸
```bash
# ë¦¬ì†ŒìŠ¤ê°€ ëª¨ë‘ ì‚­ì œë˜ì—ˆëŠ”ì§€ í™•ì¸
aws iam list-roles
aws iam list-policies
```

---

## ğŸ“š ì¶”ê°€ í•™ìŠµ ìë£Œ
- [AWS IAM ì •ì±… ë¬¸ì„œ](https://docs.aws.amazon.com/iam/latest/userguide/policies.html)
- [STS ì„œë¹„ìŠ¤ ë¬¸ì„œ](https://docs.aws.amazon.com/STS/latest/APIReference/API_GetFederationToken.html)
- [ì„œë¹„ìŠ¤ ì—°ê²° ì—­í•  ë¬¸ì„œ](https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html)