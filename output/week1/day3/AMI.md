---

| [⬅️ EC2](./EC2.md) | [📑 Day 3 목차](./README.md) | [🏠 Week 1](../README.md) | [EBS ➡️](./EBS.md) |

---

> **한 줄 정의:** AMI는 AWS의 **가상 머신 이미지** 서비스입니다.  

### 이 서비스가 해결하는 문제  
**기존의 문제점:**  
- **문제 1:** 서버를 생성할 때마다 운영체제, 앱, 설정을 매번 수동으로 구성해야 해서 시간이 많이 걸리고 실수 가능성 높음.  
  (예: 웹 서버 설정 시 Apache 설치, 포트 개방, 디렉터리 생성 등 매번 반복 작업)  
- **문제 2:** 여러 인스턴스에서 동일한 환경을 구성해야 할 때 일관성을 유지하기 어렵고, 버전 관리가 복잡함.  
  (예: 개발, 테스트, 프로덕션 환경에서 동일한 설정을 적용해야 하는 경우)  
- **문제 3:** 인스턴스가 중단되면 모든 설정이 사라져 재구성 시 시간과 자원이 추가로 소비됨.  
  (예: 스팟 인스턴스로 인한 중단 시 데이터 손실 위험)  

**AMI로 해결:**  
- **해결 1:** AMI는 미리 구성된 이미지로 인스턴스 생성 시 즉시 사용할 수 있어 시간과 노동을 절약함.  
  (예: Ubuntu AMI로 인스턴스 생성 시 기본 환경이 자동 설정됨)  
- **해결 2:** AMI를 기반으로 다양한 인스턴스를 생성해도 설정이 일관되게 유지되고 버전 관리가 용이함.  
  (예: 개발 환경 AMI를 기반으로 테스트 환경 AMI를 생성해 차이를 명확히 관리)  
- **해결 3:** EBS 볼륨과 결합해 데이터를 영구 저장해 인스턴스 중단 시 데이터 손실을 방지함.  
  (예: 웹 서버 로그 데이터를 EBS에 저장해 스팟 인스턴스 중단 후도 데이터 유지)  

### 비유로 이해하기  
AMI는 **가상 PC 이미지**에 비유할 수 있어요. 기존에는 컴퓨터를 직접 조립해야 했지만, AMI는 미리 조립된 이미지를 제공해 바로 사용할 수 있어요. 예를 들어, 웹 서버를 생성할 때 AMI를 사용하면 Apache 서버, 포트 개방, 디렉터리 생성 등 모든 설정이 자동으로 완료되어 시간을 절약할 수 있어요. 이처럼 AMI는 반복적인 설정 작업을 없애주고, 일관된 환경을 제공해 개발 생산성을 높여줍니다.  

---

## 🎯 주요 사용 시나리오 (When to Use)  

| 시나리오 | 설명 | 구체적 예시 |
|---------|------|-----------|
| 시나리오 1 | 웹 서버 배포 | 기업이 AWS를 통해 웹사이트 운영 시, Ubuntu AMI를 기반으로 인스턴스 생성 후 Apache 설치 및 설정 완료 |
| 시나리오 2 | 데이터베이스 서버 생성 | 클라우드에 MySQL 서버 배포 시, AMI에 MySQL 이미지 포함해 인스턴스 생성 후 바로 사용 |
| 시나리오 3 | 커스터마이징 환경 제공 | 개발 팀이 개발/테스트 환경을 분리해 운영할 때, 각 환경별 AMI를 생성해 일관성 유지 |

**이럴 때 AMI를 선택하세요:**  
- ✅ **일관된 환경 설정이 필요한 경우** (예: CI/CD 파이프라인에 AMI 활용)  
- ✅ **빠른 인스턴스 생성이 필요한 경우** (예: 임시 테스트 환경 생성 시)  
- ✅ **커스터마이징이 필요한 경우** (예: 특정 애플리케이션에 맞춘 AMI 생성 후 배포)  

**이럴 때는 다른 서비스를 고려하세요:**  
- ❌ **데이터 저장이 필요한 경우 → EBS** (AMI는 OS만 제공, 데이터 저장은 EBS 볼륨 필요)  
- ❌ **비용 최적화가 필요한 경우 → Spot Instances** (AMI를 기반으로 스팟 인스턴스 사용해 비용 절감)  
- ❌ **템플릿 기반 인프라 관리가 필요한 경우 → CloudFormation** (AMI를 템플릿으로 활용해 자동화)  

---

## 🔗 연관 서비스 (Used Together With)  

| 연관 서비스 | 연동 목적 | 일반적인 아키텍처 |
|------------|---------|-----------------|
| **EBS** | AMI와 함께 사용해 인스턴스에 데이터를 영구 저장 | User → EC2 (AMI 기반) → EBS |
| **EC2** | AMI로 인스턴스 생성 후 운영 | AMI → EC2 인스턴스 생성 및 관리 |
| **CloudFormation** | AMI를 템플릿으로 활용해 인프라 자동화 | CloudFormation → AMI → EC2 인스턴스 |

**자주 사용되는 아키텍처 패턴:**  
```
User → CloudFormation → AMI (템플릿) → EC2 인스턴스 → EBS (데이터 저장)
```  

---

## 💰 비용 구조 (Pricing)  

| 과금 항목 | 요금 | 프리티어 |
|----------|-----|---------|
| **EC2 인스턴스 사용** | $0.046–$0.347 / 시간 (Linux) | 월 750시간 무료 (t3.micro) |
| **EBS 저장소 사용** | $0.10–$0.15 / GB-시간 | 12개월 무료 (50GB) |
| **데이터 전송** | $0.09–$0.12 / GB | 항상 무료 (AWS 내부 전송) |

**비용 최적화 팁:**  
1. 💡 **스팟 인스턴스 사용:** 비용 절감을 위해 CPU/메모리 요구가 낮은 작업에 스팟 인스턴스 활용  
2. 💡 **예약 인스턴스 구매:** 연간 사용량이 예측 가능한 경우 예약 인스턴스로 70% 이상 비용 절감  
3. 💡 **프리티어 활용:** t3.micro 인스턴스 및 50GB EBS 저장소 무료로 시작해 비용 최소화  

> **⚠️ 비용 주의:** **데이터 전송 비용**이 예상치 못하게 발생할 수 있어요. 예를 들어, S3에서 EC2로 데이터 전송 시 $0.09/GB 비용이 발생할 수 있으니, 전송량을 모니터링하고 필요한 경우 VPC 내부 전송으로 비용 절감.

## 📚 핵심 개념

### 개념 1: AMI의 정의 및 중요성  
AMI는 **Amazon Machine Image**(Amazon 기계 이미지)로, EC2 인스턴스를 생성할 때 사용하는 템플릿입니다. 이 이미지는 운영체제, 애플리케이션, 설정 등이 포함되어 있어, 클라우드 환경에서 일관된 환경을 제공하고 인스턴스 생성 시간을 단축합니다. AMI는 AWS에서 제공하는 공개 이미지 또는 사용자가 직접 생성한 개인 이미지로 구성되며, **반복적인 설정 작업을 제거**하고, **비용 효율성**을 높이는 데 기여합니다.  

#### 왜 중요한가?  
- **일관된 환경 제공**: 애플리케이션 실행 환경을 일관되게 유지해 오류를 줄입니다.  
- **빠른 인스턴스 생성**: 이미 사전에 설정된 템플릿을 활용해 인스턴스 생성 시간을 단축합니다.  
- **비용 절감**: 반복적인 설정 작업을 줄여 인프라 운영 비용을 절감할 수 있습니다.  

#### 세부 요소  
| 요소 | 설명 | 예시 |  
|-----|-----|-----|  
| **기본 이미지** | 운영체제와 기본 애플리케이션을 포함한 템플릿 | Ubuntu 20.04 LTS AMI |  
| **사용자 데이터** | 인스턴스 생성 시 자동 실행되는 스크립트 또는 파일 | SSH 키 파일 또는 초기 설정 스크립트 |  
| **런처 퍼미션** | 특정 사용자나 그룹이 AMI를 사용할 수 있는 권한 설정 | 특정 AWS 계정이나 조직 내 사용자에게 접근 권한 부여 |  

> **💡 Tip:** AMI를 사용하면 동일한 환경을 여러 인스턴스에 복제할 수 있어, CI/CD 파이프라인에서 효율적으로 활용할 수 있습니다.  

---

### 개념 2: AMI의 구성 요소 및 작동 원리  
AMI는 **기본 이미지**, **볼륨**, **런처 퍼미션**, **사용자 데이터** 등으로 구성됩니다. 이 요소들은 인스턴스 생성 시 자동으로 적용되어, 사용자가 별도 설정 없이도 필요한 환경을 제공합니다.  

#### 작동 원리  
1. **AMI 선택**: 사용자는 AWS 콘솔이나 CLI에서 원하는 AMI를 선택합니다.  
2. **인스턴스 생성**: 선택된 AMI를 기반으로 EC2 인스턴스가 생성되며, 기본 이미지와 설정이 자동으로 복제됩니다.  
3. **사용자 데이터 적용**: 인스턴스 생성 시 사용자 데이터 스크립트가 실행되어, 추가 설정을 완료합니다.  

> **💡 Tip:** 사용자 데이터는 SSH 접속 후 초기 설정을 자동화할 수 있어, 자동화된 배포 프로세스에서 유용합니다.  

---

### 개념 3: AMI의 유형 및 주요 특징  
AMI는 **공개 AMI**, **개인 AMI**, **공유 AMI** 등으로 분류됩니다. 각 유형은 사용 목적과 접근 권한에 따라 달라지며, 특정 요구사항에 맞는 최적화된 이미지를 선택해야 합니다.  

#### 주요 특징  
1. **공개 AMI**: AWS가 제공하는 공개 이미지로, 누구나 사용할 수 있습니다. 예: Ubuntu, Amazon Linux.  
2. **개인 AMI**: 사용자가 직접 생성한 이미지로, 개인 또는 조직 내에서만 사용 가능합니다.  
3. **공유 AMI**: 사용자가 다른 AWS 계정이나 조직과 공유할 수 있는 이미지입니다.  

> **💡 Tip:** 개인 AMI는 보안성과 관리 용이성을 고려해, 내부 시스템에 최적화된 환경을 제공합니다.  
> **⚠️ 주의:** AMI를 공유할 때는 민감 정보를 포함하지 않도록 주의해야 합니다.

## 🖥️ AWS 콘솔에서 AMI 사용하기

### Step 1: AMI 서비스 접속  
1. AWS Management Console에 로그인합니다  
   - URL: https://console.aws.amazon.com  
   - **AWS 계정 ID 및 비밀번호 입력** 후 "Sign in" 버튼 클릭  
2. 상단 검색창에서 **"AMI"**를 입력하고, 검색 결과에서 **"AMIs"**를 선택합니다  
   - **"AMIs"** 메뉴는 AMI 관리, 공유, 생성 등 주요 기능을 제공합니다  

> **📸 화면 확인:** AMI 대시보드가 표시되면 정상입니다. 왼쪽 메뉴에서 "My AMIs" 또는 "Shared AMIs" 탭을 선택하면 해당 리소스를 확인할 수 있습니다.  

---

### Step 2: [주요 작업 1 - 리소스 생성]  
1. **인스턴스 생성 후 AMI 생성**  
   - **AWS EC2 콘솔에서 인스턴스를 생성**한 후, 해당 인스턴스를 기반으로 AMI를 생성합니다  
   - **예:** 웹 서버를 설치한 인스턴스를 기반으로 AMI를 생성하여 재사용  
2. **AMI 생성 단계**  
   - EC2 콘솔에서 인스턴스 선택 → **"Actions" → "Image" → "Create image"**  
   - **이름 및 설명** 입력 (예: `WebServer-AMI-v1`)  
   - **Storage Options**에서 EBS 볼륨 선택 (기본값: 8GB)  
   - **Tags**에 사용자 정의 태그 추가 (예: `Project: DevOps`)  
3. **확인 사항**  
   - AMI 생성 중 **"Creating" 상태**가 표시되면 정상 진행 중입니다  
   - 생성 완료 후 **"Available" 상태**로 전환되면 사용 가능  

> **📸 화면 확인:** EC2 콘솔에서 인스턴스 선택 후 "Create image" 버튼 클릭 시 화면이 전환되고, AMI 생성 프로세스가 시작됩니다.  

---

### Step 3: [주요 작업 2 - 설정/구성]  
1. **AMI 공유 설정**  
   - AMI 생성 후 **"Actions" → "Share AMI"**  
   - **"Specific accounts"** 또는 **"All AWS accounts"** 선택하여 공유 대상 설정  
   - **"Public"**으로 설정 시 AWS Marketplace에 등록 가능 (비용 발생)  
2. **AMI 템플릿 수정**  
   - **"Actions" → "Edit"**  
   - **Description** 또는 **Tags** 수정 후 **"Save"**  
3. **AMI 권한 확인**  
   - **"Permissions"** 탭에서 **"Launch Permission"** 설정 확인  
   - 특정 계정 또는 공개 여부를 조정할 수 있습니다  

> **⚠️ 주의:** AMI 생성 시 **EBS 볼륨 크기**를 조정하면 저장 공간 비용이 증가할 수 있습니다. 필요에 따라 **"Storage Options"**에서 조정하세요.  

---

### Step 4: 설정 확인 및 테스트  
1. **생성된 AMI 확인 방법**  
   - AMI 대시보드에서 **"My AMIs"** 탭 → 생성한 AMI 이름 클릭  
   - **"State"**가 **"Available"**인지 확인 (생성 완료 상태)  
2. **AMI 상태 확인**  
   - **"Details"** 탭에서 **"Launch Permissions"**, **"Tags"**, **"Description"** 확인  
   - **"Public"** 또는 **"Private"** 설정이 정확히 반영되었는지 확인  
3. **AMI 테스트 방법**  
   - **"Launch"** 버튼 클릭 → 인스턴스 생성  
   - SSH로 접속 후 웹 서버 상태 확인 (예: `curl http://localhost` 또는 `systemctl status apache2`)  
   - **"Public IP"**를 통해 외부에서 접근 가능 여부 테스트  

> **💡 Tip:** AMI 생성 시 **"Free Tier"**를 활용하면 비용이 발생하지 않습니다. 7일간 무료로 사용 가능합니다.  

---

### ✅ 실무 예제: 웹 서버 AMI 생성  
1. **EC2 인스턴스 생성**  
   - 인스턴스 유형: `t2.micro` (Free Tier)  
   - AMI: `Ubuntu Server 22.04 LTS`  
   - SSH 키 쌍 생성 후 다운로드  
2. **웹 서버 설치**  
   - SSH 접속 후 `sudo apt update && sudo apt install apache2`  
   - `sudo systemctl enable apache2`  
3. **AMI 생성**  
   - 인스턴스 종료 후 `Create image` → AMI 생성  
4. **AMI 재사용**  
   - 생성한 AMI로 새로운 인스턴스 생성 → SSH 접속 후 웹 서버 확인  

> **📊 비용 요약:**  
| 항목 | 비용 |  
|------|------|  
| t2.micro 인스턴스 | $0 (Free Tier) |  
| AMI 생성 | 무료 (1회) |  
| AMI 재사용 | $0 (Free Tier) |  

--- 

### 📌 추가 팁  
- **AMI 공유** 시 AWS Marketplace에 등록하면 다른 사용자에게 제공할 수 있습니다.  
- **AMI 복제**를 통해 여러 지역에 배포할 수 있습니다.  
- **"Snapshots"**를 활용해 EBS 볼륨을 백업하고 AMI 생성 시 사용할 수 있습니다.

## ⌨️ AWS CLI로 AMI 사용하기

### 사전 준비
```bash
# AWS CLI 버전 확인
aws --version

# AWS 자격 증명 확인
aws sts get-caller-identity

# 현재 리전 확인
aws configure get region
```

> **💡 Tip:** AWS CLI를 사용하기 전에 `aws configure`로 액세스 키, 시크릿 액세스 키, 리전을 설정해야 합니다.  
> `aws configure set region us-east-1` 명령어로 리전을 설정할 수 있습니다.

---

### 예제 1: AMI 리소스 조회
```bash
# [AMI 목록 조회]
aws ec2 describe-images --owners self --query 'Images[].ImageId' --output table
```

**옵션 설명:**
| 옵션 | 설명 | 예시 값 |
|-----|-----|--------|
| `--owners` | AMI 소유자 필터링 | `self` (자신의 AMI) |
| `--query` | 결과 필터링 | `'Images[].ImageId'` (AMI ID만 출력) |
| `--output` | 출력 형식 | `table` (테이블 형식) |

**예상 출력:**
```
| ImageId |
|---------|
| ami-1234567890abcdef0 |
| ami-0987654321abcdef0 |
```

> **⚠️ 주의:** `describe-images`는 모든 AMI를 반환하므로, 필터링 옵션을 반드시 사용해야 합니다.

---

### 예제 2: AMI 생성
```bash
# [AMI 생성]
aws ec2 create-image \
    --instance-id i-0abcdef1234567890 \
    --name "MyCustomAMI" \
    --description "Custom AMI for Dev Environment" \
    --no-reboot
```

**필수 옵션:**
- `--instance-id`: 기반 인스턴스 ID (AMI 생성 시 사용)
- `--name`: 생성할 AMI 이름
- `--no-reboot`: 인스턴스 재부팅 없이 AMI 생성

**예상 출력:**
```json
{
    "ImageId": "ami-1234567890abcdef0"
}
```

> **💡 Tip:** 인스턴스를 종료하고 AMI 생성해야 합니다. `--no-reboot` 옵션은 인스턴스 재부팅 없이 AMI 생성을 시도합니다.

---

### 예제 3: AMI 수정
```bash
# [AMI 속성 수정]
aws ec2 modify-image-attribute \
    --image-id ami-1234567890abcdef0 \
    --launch-permission "Add":{"UserIds":["123456789012"]}
```

**수정 가능한 속성:**
- `launch-permission`: AMI 공유 대상 설정
- `description`: AMI 설명 변경
- `name`: AMI 이름 변경

**예상 출력:**
```json
{
    "ImageId": "ami-1234567890abcdef0"
}
```

> **⚠️ 주의:** AMI는 불변입니다. 수정은 속성 변경에 한정됩니다.

---

### 예제 4: AMI 삭제
```bash
# [AMI 삭제]
aws ec2 delete-image --image-id ami-1234567890abcdef0

# 삭제 확인
aws ec2 describe-images --image-ids ami-1234567890abcdef0
```

**삭제 후 출력 예시:**
```
{
    "Images": []
}
```

> **⚠️ 주의:** AMI 삭제는 되돌릴 수 없습니다. 삭제 전에 `describe-images`로 상태를 확인하세요.

---

### 자주 사용하는 명령어 정리
```bash
# 조회
aws ec2 describe-images --owners self --query 'Images[].ImageId' --output table
aws ec2 describe-images --image-ids ami-1234567890abcdef0

# 생성
aws ec2 create-image --instance-id i-0abcdef1234567890 --name "MyCustomAMI"

# 수정
aws ec2 modify-image-attribute --image-id ami-1234567890abcdef0 --description "Updated Description"

# 삭제
aws ec2 delete-image --image-id ami-1234567890abcdef0
```

> **💡 Tip:** AMI 생성 시 인스턴스를 종료하고, 생성 후 인스턴스를 삭제하는 것이 좋습니다.  
> `aws ec2 terminate-instances --instance-ids i-0abcdef1234567890` 명령어로 인스턴스 종료.

## 🎯 SAA-C03 시험 핵심 포인트

### 시험에서 자주 출제되는 AMI 포인트

#### 📌 핵심 출제 포인트 TOP 5
1. **AMI 생성 및 커스터마이징**  
   - 설명: AMI는 EC2 인스턴스를 빠르게 배포하고 일관된 환경을 제공하는 핵심 기능으로, 시험에서 빈번히 AMI 생성 방법, 커스터마이징 단계(예: User Data, 파티션 설정), 및 커스터마이징된 AMI 저장 방법을 묻습니다.  
   - 키워드: `AMI 생성`, `커스터마이징`, `User Data`

2. **AMI 유형 및 사용 사례**  
   - 설명: 공개 AMI, 개인 AMI, 공유 AMI의 차이점과 각각의 사용 시나리오(예: 공개 AMI는 공유, 개인 AMI는 보안, 공유 AMI는 팀 내 공유)는 시험에서 반드시 정확히 구분해야 하는 내용입니다.  
   - 키워드: `공개 AMI`, `개인 AMI`, `공유 AMI`

3. **인스턴스 런치 시 AMI 선택 옵션**  
   - 설명: AMI를 기반으로 인스턴스를 런치할 때 옵션(예: 템플릿 선택, 인스턴스 유형 지정)과 관련된 문제는 시험에서 빈번히 출제됩니다.  
   - 키워드: `인스턴스 런치`, `AMI 선택`, `템플릿`

4. **AMI vs EBS 차이점**  
   - 설명: AMI는 인스턴스 템플릿이며, EBS는 볼륨 저장소로, 두 서비스의 혼동을 피하는 것이 중요합니다. 시험에서는 "데이터 저장" 또는 "환경 배포" 관련 질문에서 이 구분을 묻습니다.  
   - 키워드: `AMI vs EBS`, `템플릿 vs 저장소`, `인스턴스 vs 볼륨`

5. **비용 최적화(예: 예약 인스턴스, 스포트 인스턴스)**  
   - 설명: AMI를 기반으로 인스턴스를 실행할 때 구매 옵션(예: 스포트 인스턴스 사용 시 비용 절감)과 관련된 비용 구조는 시험에서 중요한 주제입니다.  
   - 키워드: `예약 인스턴스`, `스포트 인스턴스`, `비용 최적화`

#### ⚠️ 시험에서 자주 나오는 함정
| 함정 유형 | 설명 | 올바른 답변 |
|----------|------|------------|
| 함정 1 | "AMI는 데이터 저장소입니다"라고 기술된 문제에서 AMI를 EBS로 오인하는 경우 | AMI는 인스턴스 템플릿, EBS는 데이터 저장소 |
| 함정 2 | "공유 AMI는 누구에게 제공되나요?"에 대해 개인 AMI로 오인하는 경우 | 공유 AMI는 AWS 계정 간에 공유 가능 |
| 함정 3 | "스포트 인스턴스는 어떤 경우에 사용해야 하나요?"에 대해 일반 인스턴스로 오인하는 경우 | 비용이 낮은 작업(예: 배치 처리)에 사용 |

#### 🔄 AMI vs 비슷한 서비스 비교 (시험 단골!)
| 비교 항목 | AMI | 대안 서비스 | 선택 기준 |
|----------|----------|-----------|----------|
| 용도 | 인스턴스 템플릿으로 EC2 인스턴스 생성 | EBS(볼륨 저장소), S3(파일 저장소), Snapshots(백업) | 인스턴스 환경 배포 시 |
| 확장성 | 여러 인스턴스에 동일한 환경 제공 | EBS는 볼륨 복제, S3는 파일 공유 | 동일 환경 배포가 필요한 경우 |
| 비용 | 예약/스포트 인스턴스 구매 옵션 활용 | EBS는 볼륨 요금제, S3는 스토리지 요금제 | 인스턴스 실행 비용 최적화 시 |
| 지연시간 | 즉시 인스턴스 생성 가능 | Snapshots는 볼륨 복제 시 시간 소요 | 빠른 배포가 필요한 경우 |

#### 📝 시험 대비 체크리스트
- [ ] AMI의 핵심 목적을 한 문장으로 설명할 수 있는가?  
  *예: "AMI는 EC2 인스턴스를 빠르게 배포하고 일관된 환경을 제공하는 템플릿입니다."*
- [ ] AMI를 선택해야 하는 시나리오를 알고 있는가?  
  *예: "동일한 OS 및 애플리케이션 환경을 여러 인스턴스에 배포해야 할 때"*
- [ ] AMI의 제한사항/한계를 알고 있는가?  
  *예: "AMI는 인스턴스 생성 시만 사용 가능, 데이터 저장은 EBS로 관리해야 함"*
- [ ] AMI와 비슷한 서비스의 차이점을 설명할 수 있는가?  
  *예: "AMI는 인스턴스 템플릿, EBS는 볼륨 저장소로 기능이 다름"*
- [ ] AMI의 비용 구조를 이해하고 있는가?  
  *예: "예약 인스턴스로 비용 절감, 스포트 인스턴스는 저비용 작업에 적합"*

#### 💡 시험 팁
> **키워드 매칭:** 문제에서 이런 키워드가 나오면 AMI를 떠올리세요:  
> - `템플릿`, `커스터마이징`, `인스턴스 생성`, `비용 최적화`, `공유 AMI`

---

| [⬅️ EC2](./EC2.md) | [📑 Day 3 목차](./README.md) | [🏠 Week 1](../README.md) | [EBS ➡️](./EBS.md) |

---
